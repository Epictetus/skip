$j(function(){$j.ajaxSetup({ifModified:false,cache:false,error:function(request){if(request.responseText==""){alert("通信に失敗しました。")}else{alert(request.responseText)}}});$j("span.ss_help").cluetip({splitTitle:"|",dropShadow:false,cluetipClass:"jtip",arrows:true});$j.fn.highlight=function(color){var afterColor="#ffffff";if(color!=undefined){afterColor=color}return this.css({backgroundColor:"#ffffbb"}).animate({backgroundColor:afterColor},300)};$j.fn.zoomable=function(){return this.hover(function(){var img=$j(this).find("img")[0];var span=$j(document.createElement("span")).css({position:"absolute",top:img.offsetTop+"px",left:img.offsetLeft+"px",width:img.offsetWidth+"px",height:img.offsetHeight+"px"}).addClass("image_over");$j(this).prepend(span)},function(){$j(this).find(".image_over").remove()})};$j.fn.appendClickForToggleTag=function(){this.find(".tag_open").click(function(){$j(this).hide().next().show().parent().highlight();return false});this.find(".tag_close").click(function(){$j(this).parent().hide().prev().show().parent().highlight();return false});return this};$j(document).appendClickForToggleTag();$j("select.select_navi").dropdownNavigation();$j("img.fit_image").fitimage({placeholder:relative_url_root+"/images/skip/jquery/fitimage/spacer.gif"});var loadCalendar=function(year,month,url){$j.ajax({url:url,data:{year:year,month:month},success:function(html){$j("#calendar").html(html);$j("#calendar_body").highlight()},complete:function(request){setupLoadCalendar(url)}})};var unbindLoadCalendar=function(){$j("#prev_month_link").unbind("click");$j("#next_month_link").unbind("click")};var bindLoadCalendar=function(url){$j("#prev_month_link").click(function(){loadCalendar($j(this).attr("year"),$j(this).attr("month"),url);return false});$j("#next_month_link").click(function(){loadCalendar($j(this).attr("year"),$j(this).attr("month"),url);return false})};setupLoadCalendar=function(url){unbindLoadCalendar();bindLoadCalendar(url)};$j(".share_file_download_link").click(function(){var shareFileId=this.id.split("_")[4];$j("#download_count_"+shareFileId).html(eval($j("#download_count_"+shareFileId).html())+1)});setupShareFileDownloadLink=function(){$j(".share_file_download_link").click(function(){$j("#share_file_download_form_"+this.id.split("_")[4]).submit();return false})};showCategoryBox=function(){$j("#category_box:hidden").slideDown()};hideCategoryBox=function(){$j("#category_box:visible").slideUp()};reloadTitle=function(url,target_id){$j("#refresher").hide();$j("#indicator").show();var ado_get_title_url=relative_url_root+"/bookmark/ado_get_title";$j.ajax({type:"POST",url:ado_get_title_url,data:{url:url,authenticity_token:$j("#authenticity_token").val()},success:function(request){if(request==""){alert("タイトルの取得ができませんでした");return}else{$j("#"+target_id).val(request)}},complete:function(request){$j("#indicator").hide();$j("#refresher").show()},error:function(request){alert(request.responseText)}})};createTagsLink=function(tags){var text="";$j.each(tags,function(){text+='<a href="#" onclick="return false;" style="margin-right: 3px;">'+this.toString()+"</a>"});return text};setCurrentDatetime=function(obj_name,property_name){var currentDatetime=new Date();var year_obj=document.getElementsByName(obj_name+"["+property_name+"(1i)]");var month_obj=document.getElementsByName(obj_name+"["+property_name+"(2i)]");var date_obj=document.getElementsByName(obj_name+"["+property_name+"(3i)]");var hour_obj=document.getElementsByName(obj_name+"["+property_name+"(4i)]");var minute_obj=document.getElementsByName(obj_name+"["+property_name+"(5i)]");year_obj[0].value=currentDatetime.getFullYear();month_obj[0].value=currentDatetime.getMonth()+1;date_obj[0].value=currentDatetime.getDate();var currentHour=currentDatetime.getHours();if(currentHour<10){currentHour="0"+currentHour}hour_obj[0].value=currentHour;var currentMinute=currentDatetime.getMinutes();if(currentMinute<10){currentMinute="0"+currentMinute}minute_obj[0].value=currentMinute};$j.extend({getUrlVars:function(url_or_href){var vars=[],hash;var hashes=url_or_href.slice(url_or_href.indexOf("?")+1).split("&");for(var i=0;i<hashes.length;i++){hash=hashes[i].split("=");vars.push(hash[0]);vars[hash[0]]=hash[1]}return vars},getUrlVar:function(url_or_href,name){return $j.getUrlVars(url_or_href)[name]}});$j(".zoomable").zoomable();$j("table.sortable").tablesorter()});(function(){jQuery.fn.dropdownNavigation=function(b){function a(){var c=jQuery(this).val();if(""!=c){document.location=c}return false}return jQuery(this).change(a)}})(jQuery);(function(){jQuery.fn.labeledTextField=function(b){var d=jQuery(this);var a=b.focusClass||"focus";var c=b.message;d.parents("form").get(0).reset();if(d.val()!=c){d.addClass(a)}d.focus(function(){d.addClass(a);if(d.val()==c){d.val("")}});d.blur(function(){if(d.val()==""){d.removeClass(a).val(c)}});d.parents("form").submit(function(){if(d.val()==c){d.val("")}return true});return d}})(jQuery);jQuery.fn.flashMessage=function(c,e){var d=jQuery(this);if(jQuery.browser.ie){var a=d.position();var f=jQuery("<iframe id='ie-select-fix'></iframe>").attr("src",e+"/blank").css("z-index",d.css("z-index")).css("width",d.width()).css("height",d.height()).css("top",a.top).css("left",a.left);d.css("z-index",Number(f.css("z-index"))+1).after(f)}d.find(" > div").click(function(){jQuery("#ie-select-fix").hide();jQuery(this).fadeOut()});function b(g,i,h){jQuery("#ie-select-fix").show();d.find("div."+g).show().find("h3").text(i);if(h){setTimeout(function(){d.find("div."+g).trigger("click")},h*1000)}}d.bind("error",function(g,h){b("error",h)}).bind("warn",function(g,h){b("warn",h,5)}).bind("notice",function(g,h){b("notice",h,2)});jQuery.each(c,function(g,h){d.triggerHandler(g,h)});return d};(function(){jQuery.fn.iframeUploader=function(c){var a;function f(){var j=jQuery(this.contentWindow.document).find("form");if(c.trigger=="submit"){b(j)}else{e(j)}}function b(j){j.submit(function(){var k=j.find("td.indicator img").show();j.get(0).submit();k.hide();var l=j.find("input[type=file]");l.focus();a=function(){j.get(0).reset()};return false})}function e(j){var k=null;j.find("input").change(function(){if(k){clearTimeout(k)}var m=j.find("input[type=file]");if(m.val().length>0){var l=j.find("td.indicator img").show();submit=function(){j.submit();j.get(0).reset();l.hide();m.focus();k=null};k=setTimeout(submit,5*1000)}else{return}})}var d=function(){if(a){a.call()}i.call(this,h)};var g=jQuery(this);var i=c.callback;jQuery("<div>").addClass("form").append(jQuery("<iframe>").attr("src",c.src["form"]).load(f)).appendTo(g);var h=jQuery("<iframe>").attr("src",c.src["target"]).attr("name",c.target).one("load",function(){jQuery(this).load(d)});jQuery("<div>").addClass("target").append(h).appendTo(g);h.get(0).contentWindow.name=c.target}})(jQuery);