<div class="edit_form_space bookmark edit">
  <div class="desc ui-corner-all">
    <p><%=h _('You can save an URL you are interested in with a comment to a bookmark. You can also share it with other users by publishing it. Enter a URL below and click the "Next" button to start with.') %></p>
  </div>
  <div class="update_form_wrapper">
    <% form_for Bookmark.new, :url => polymorphic_path([current_tenant, :bookmarks], :action => :new_without_bookmarklet), :html => {:method => :get} do |f| -%>
      <table>
        <tr>
          <th><%= f.label :url, _('URL') %></th>
          <td><%= f.text_field :url, :size => 50 %><%= f.submit _('Next') %></td>
        </tr>
      </table>
    <% end -%>
  </div>
</div>

<p>
<%= _('Bookmarklet') %>:
<% if request.headers["HTTP_USER_AGENT"] =~ /MSIE [56]/ -%>
  <a href="javascript:void(function(){(function(){location.replace('about:blank');document.write('<html><body><form action=&quot;<%= new_polymorphic_url([current_tenant, :bookmark]) %>&quot; method=&quot;get&quot;><input type=hidden name=&quot;bookmark[url]&quot; value=&quot;'+location.href+'&quot;><input type=hidden name=&quot;Bookmark[title]&quot; value=&quot;'+document.title+'&quot;>'+document.title+'<br/><input type=submit value=&quot;Bookmark This&quot;></div></form><script>document.forms[0].submit();</script></body></html>');document.close();})();})()"><%= _("Add as %s bookmark") % h(Admin::Setting.abbr_app_title(current_tenant)) -%></a>
<% else -%>
<a href="javascript:void(function(){(function(){location.replace('about:blank');document.write('<html><body><form action=&quot;<%= new_polymorphic_url([current_tenant, :bookmark]) %>&quot; method=&quot;get&quot;><input type=hidden name=&quot;bookmark[url]&quot; value=&quot;'+location.href+'&quot;><input type=hidden name=&quot;bookmark[title]&quot; value=&quot;'+document.title+'&quot;><div style=\'display: none;\'>'+document.title+'<br/><input type=submit value=&quot;Bookmark This&quot;></div></form><script>document.forms[0].submit();</script></body></html>');document.close();})();})()"><%= _("Add as %s bookmark") % h(Admin::Setting.abbr_app_title(current_tenant)) -%></a>
<% end -%>
</p>

<% content_for :javascript_initializers do -%>
  $j('form').submit(function(){
      if( !$j('input#bookmark_url').val().match(/^https?:\/\/.*/) ){
          alert('<%= _('URL to be bookmarked must start with "http".')%>');
          return false;
      }
  });
<% end -%>
