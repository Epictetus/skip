<% @revert_columns = %w(enable_user_lock user_lock_trial_limit enable_password_periodic_change password_change_interval password_strength custom_password_strength_regex custom_password_strength_validation_message enable_login_keyphrase login_keyphrase enable_user_cleaning_notification user_cleaning_notification_interval) -%>
<h3><%= _('ログイン失敗によるロック') %></h3>
<div class="box tabular">
  <p><%= settings_label_with_check_box_tag :enable_user_lock %></p>
  <p><%= settings_label_with_select_tag :user_lock_trial_limit, (3..10).to_a, Admin::Setting.user_lock_trial_limit.to_i %></p>
</div>
<h3><%= _('パスワード定期変更') %></h3>
<div class="box tabular">
  <p><%= settings_label_with_check_box_tag :enable_password_periodic_change %></p>
  <p><%= settings_label_with_text_field_tag :password_change_interval %></p>
</div>
<h3><%= _('パスワード強度') %></h3>
<div class="box tabular">
  <p><%= settings_label_with_select_tag :password_strength, password_strength_container, h(Admin::Setting.password_strength.to_s) %></p>
  <span id="custom_password_strength">
    <p><%= settings_label_with_text_field_tag :custom_password_strength_regex, :size => 40, :disabled => 'disabled' %></p>
    <p><%= settings_label_with_text_field_tag :custom_password_strength_validation_message, :size => 40, :disabled => 'disabled' %></p>
  </span>
</div>
<h3><%= _('ログインキーフレーズ') %></h3>
<div class="box tabular">
  <p><%= settings_label_with_check_box_tag :enable_login_keyphrase %></p>
  <p><%= settings_label_with_text_field_tag :login_keyphrase %></p>
</div>
<h3><%= _('クリーニング依頼メール') %></h3>
<div class="box tabular">
  <p><%= settings_label_with_check_box_tag :enable_user_cleaning_notification %></p>
  <p><%= settings_label_with_select_tag :user_cleaning_notification_interval, [1, 3, 6, 12], Admin::Setting.user_cleaning_notification_interval.to_i %></p>
</div>

<% content_for :javascript do -%>
<script type="text/javascript">
$j(function(){
    var toggleCustomPasswordStrength = function() {
        if($j('#setting_password_strength').val() == 'custom') {
            $j('#custom_password_strength input').removeAttr('disabled');
        } else {
            $j('#custom_password_strength input').attr('disabled', 'disabled');
        }
    };
    $j('#setting_password_strength')
    .keyup(function(event){
        if(event.keyCode == 38 || event.keyCode == 40)
            toggleCustomPasswordStrength();
    })
    .change(function(){
        toggleCustomPasswordStrength();
    });
    toggleCustomPasswordStrength();
});
</script>
<% end -%>
