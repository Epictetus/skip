<%
  # FIXME 要リファクタ
  month_archives =
    BoardEntry.accessible(current_user).owned(current_target_owner).find(
      :all,
      :select => "YEAR(date) as year, MONTH(date) as month, count(distinct board_entries.id) as count",
      :group => "year, month",
      :order => "year desc, month desc")
-%>

<div class="box_space">
  <div class="box_space_title"><%= icon_tag 'page_white_zip' -%><%= _('Monthly List')%></div>
  <div class="box_space_body" style="font-size: 10px;">
  <ul style="list-style-position: inside; list-style-type: disc;">
  <% month_archives.each do |archive| -%>
    <% link_text =  _("%{month}/%{year} (%{count})") % {:year => archive.year, :month => archive.month, :count => archive.count} -%>
    <li><%= link_to link_text, polymorphic_path([current_tenant, current_target_owner, :board_entries], :search => {:date_year_and_month => {:year => archive.year, :month => archive.month}}) %></li>
  <% end -%>
  </ul>
  <br style="display: none; clear:left;" />
  </div>
  <div class="box_space_bottom"></div>
</div><!-- box_space -->
